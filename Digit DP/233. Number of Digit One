class Solution {
    public int countDigitOne(int n) {
       String s = String.valueOf(n);   //number to string
    //    return solve(s, 0, 1, 0);
    // }
    // private int solve(String s, int idx, int tight, int count){
    //     if(idx == s.length()){
    //         return count;
    //     }
    //     int lb = 0;
    //     int ub = (tight == 1)?s.charAt(idx)-'0':9;
    //     int res = 0;

    //     for(int digit = lb; digit <= ub; digit++){
    //          int newTight = (tight == 1 && digit == ub) ? 1 : 0;

    //         if (digit == 1) {
    //             res += solve(s, idx + 1, newTight, count + 1);
    //         } else {
    //             res += solve(s, idx + 1, newTight, count);
    //         }
    //     }

    //     return res;






        int[][][] dp = new int[11][2][10];   //index,tight,count
          for (int i = 0; i < 11; i++) {
            for (int j = 0; j < 2; j++) {
                Arrays.fill(dp[i][j], -1);
            }
        }
        int ans = solve(s,0,1,0,dp);
        return ans;
        
    }
    private int solve(String s, int idx, int tight, int count,int dp[][][]) {
        if (idx == s.length()) {
            return count;
        }
        if (dp[idx][tight][count] != -1) {
            return dp[idx][tight][count];
        }
        int lb = 0;
        int ub = (tight == 1) ? s.charAt(idx) - '0' : 9;
        int res = 0;

        for (int digit = lb; digit <= ub; digit++) {

            int newTight = (tight == 1 && digit == ub) ? 1 : 0;

            if (digit == 1) {
                res += solve(s, idx + 1, newTight, count + 1,dp);
            } else {
                res += solve(s, idx + 1, newTight, count,dp);
            }
        }
        return dp[idx][tight][count] = res;
    }    
}
